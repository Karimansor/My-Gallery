<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Love Gallery</title>
  <style>
    .gallery {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .card {
      text-align: center;
    }
    .card img {
      width: 250px;
      height: 250px;
      object-fit: cover;
      border-radius: 8px;
    }
    button {
      margin-top: 5px;
      background-color: #e53935;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="gallery" id="gallery"></div>
  <script>
    const username = "Karimansor";
    const repo = "photo-gallery";
    const workerURL = "https://workers-playground-polished-hall-c580.karman-jobs-72e.workers.dev/love";

    const images = [
      "e42ef148-0950-4f0d-8f36-f23bf303ab57.jpg",
      "5899c016-9891-4cd1-853e-7b96e230d587.jpg",
      "07ac23da-e373-4705-ab3c-551c4db540f7.jpg",
      "6d1ebd0d-aaf5-4ccc-8bae-5b808c82fdeb.jpg",
      "5cca1358-a80c-463d-9fa8-d0d032687ed6.jpg",
      "812ffdb3-6931-4574-b90d-dbf5ed0767c5.jpg",
      "7122cc76-fa5e-4fef-b2aa-ceac0c86079d.jpg",
      "3a59ce60-14df-4ec3-9241-79c8584518dd.jpg",
      "1720531175352.jpg",
      "1720531175455.jpg",
      "IMG_20250106_151419.jpg",
      "IMG_20250106_151419_2.jpg",
      "IMG_20250106_151417_1.jpg",
      "IMG_20241228_151930_1.jpg",
      "IMG_20241228_151929_1.jpg",
      "IMG_20241228_151928_1.jpg",
      "IMG_20241228_151927_1.jpg",
      "IMG_20241225_162943.jpg",
      "IMG_20241224_124440.jpg",
      "IMG_20241224_124312.jpg",
      "IMG_20241224_124219.jpg",
      "IMG_20241222_204838.jpg",
      "IMG_20241222_172030.jpg",
      "IMG_20241221_145928_1.jpg",
      "IMG_20241221_145927_1.jpg",
      "IMG_20241221_145926_1.jpg",
      "IMG_20241221_145924.jpg"
    ];

    async function loadLoves() {
      const res = await fetch(`https://raw.githubusercontent.com/${username}/${repo}/main/loves.json`);
      const data = await res.json();
      const gallery = document.getElementById("gallery");
      gallery.innerHTML = "";

      images.forEach(img => {
        const card = document.createElement("div");
        card.className = "card";

        const imageEl = document.createElement("img");
        imageEl.src = `images/${img}`;
        imageEl.alt = img;

        const count = document.createElement("p");
        count.id = `count-${img}`;
        count.textContent = `${data[img] || 0} ❤️`;

        const btn = document.createElement("button");
        btn.textContent = "Love";
        btn.onclick = () => sendLove(img);

        card.appendChild(imageEl);
        card.appendChild(count);
        card.appendChild(btn);
        gallery.appendChild(card);
      });
    }

    async function sendLove(imageName) {
      const res = await fetch(`${workerURL}?image=${encodeURIComponent(imageName)}`);
      if (res.ok) {
        alert("Love added!");
        setTimeout(loadLoves, 2000); // refresh after a short delay
      } else {
        alert("Failed to send love");
        console.error(await res.text());
      }
    }

    loadLoves();
  </script>

</body>
</html>
